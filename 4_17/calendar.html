<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link rel="stylesheet" href="../fontawesome-free-5.12.1-web/css/all.css">
    <title>Hello calendar</title>
    <style>
        body {
            font-family: 'Microsoft JhengHei';
        }

        .holiday {
            background-color: #EEA9A9;
        }

        th {
            background-color: #FAF0E6;
        }
    </style>
</head>

<body>

    <div class="container">
        <div class="row d-flex justify-content-center w-100">
            <div class="month d-flex justify-content-center mt-5">
                <button type="button" class="btn btn-light justify-content-star" id="lastMonth"><i
                        class="fas fa-chevron-left"></i></button>
                <h3 id="month">month </h3>
                <button type="button" class="btn btn-light" id="nextMonth"><i class="fas fa-chevron-right"></i></button>
                <button type="button" class="btn btn-outline-primary btn-sm ml-4">新增事件</button>
            </div>
        </div>
        <div class="row mt-2">
            <table class=" table w-100 justify-content-center table-bordered text-center" id="weekly">
                <thead>
                    <th class="holiday">Sun</th>
                    <th>Mon</th>
                    <th>Tue</th>
                    <th>Wed</th>
                    <th>Thu</th>
                    <th>Fri</th>
                    <th class="holiday">Sat</th>
                </thead>
                <tbody id="date"></tbody>
            </table>
        </div>
    </div>

    <script>
        var month = document.getElementById('month');
        var _nowTime = new Date();
        console.log(_nowTime);
        var _nowDay = _nowTime.getDate();
        console.log(_nowDay);
        _dayOfWeek = _nowTime.getDay();
        console.log(_dayOfWeek);

        var _month = _nowTime.getMonth();
        // var _month = _nowTime.getMonth()+1;
        console.log(_month);
        var _year = _nowTime.getFullYear();
        console.log(_year);
        var _lastMonthDay = new Date(_year, _month, 0);
        console.log(_lastMonthDay);
        var _firstMonthDay = new Date(_year, _month, 1);
        console.log(_firstMonthDay);
        var _tbody = document.getElementById('date');

        var _monthEnglish = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
        
        month.innerHTML = _year + ' ' + _monthEnglish[_month];
        // debugger;
        setday()        
        var _lastMonth = document.getElementById('lastMonth');
        _lastMonth.addEventListener('click', lastMonth);
        function lastMonth() {
            // debugger;           
            if (_month == 0) {
                _month = 11;
                _year = _year - 1;
                month.innerHTML = _year + ' ' + _monthEnglish[_month];

            } else {
                _month = _month - 1;
                console.log(_month);
                month.innerHTML = _year + ' ' + _monthEnglish[_month];
            }
            _tbody.innerText='';
            setday();
        }

        var _nextMonth = document.getElementById('nextMonth');
        _nextMonth.addEventListener('click', nextMonth);
        function nextMonth() {
            if (_month == 11) {
                _month = 0;
                _year = _year + 1;
                month.innerHTML = _year + ' ' + _monthEnglish[_month];
            }
            else {
                _month = _month + 1;
                console.log(_month);
                month.innerHTML = _year + ' ' + _monthEnglish[_month];
            }
            _tbody.innerText='';
            setday();
        }



        function setday() {
            var _firstMonthDay = new Date(_year, _month, 1);
            var _firstDay = _firstMonthDay.getDay();
            console.log(_firstDay);

            var _lastDay = new Date(_year, _month + 1, 0).getDate();
            console.log(_lastDay);

            var cal = 1;
            let _tr = document.createElement('tr');
            for (let weekly = 0; weekly < 7; weekly++) {
                let _td = document.createElement('td');
                if (weekly >= _firstDay) {
                    _td.innerText = cal;
                    cal++;
                }
                _tr.appendChild(_td);
            }
            _tbody.appendChild(_tr);

            //console.log(cal)
            //console.log(Math.ceil((_lastDay-cal+1)/7));
            var rows = Math.ceil((_lastDay - cal + 1) / 7);
            for (let row = 0; row < rows; row++) {
                let _tr = document.createElement('tr');
                for (let days = 0; days < 7; days++) {
                    let _td = document.createElement('td');
                    if (cal <= _lastDay) {
                        _td.innerText = cal;
                    }
                    cal++;
                    _tr.appendChild(_td);
                }
                _tbody.appendChild(_tr);
            }
        }


        // var cal = 1;
        // let _tr = document.createElement('tr');
        // for (let weekly = 0; weekly < 7; weekly++) {
        //     let _td = document.createElement('td');
        //     if (weekly >= _firstDay) {
        //         _td.innerText = cal;
        //         cal++;
        //     }
        //     _tr.appendChild(_td);
        // }
        // _tbody.appendChild(_tr);

        // //console.log(cal)
        // //console.log(Math.ceil((_lastDay-cal+1)/7));
        // var rows = Math.ceil((_lastDay-cal+1)/7);
        // for (let row = 0; row < rows; row++) {        
        //     let _tr = document.createElement('tr');
        //     for (let days = 0; days < 7; days++) {
        //         let _td = document.createElement('td');
        //             if(cal<=_lastDay){
        //                 _td.innerText = cal;
        //             }                
        //         cal++;
        //         _tr.appendChild(_td);
        //     }
        //     _tbody.appendChild(_tr);
        // }


    </script>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
        integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
        integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
        crossorigin="anonymous"></script>
</body>

</html>